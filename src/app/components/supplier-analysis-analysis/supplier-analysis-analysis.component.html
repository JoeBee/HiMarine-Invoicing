<div class="supplier-analysis-analysis-container">
    <div class="content-wrapper">
        <h1>Supplier Analysis</h1>

        <div *ngIf="isLoading" class="loading-message">
            <p>Loading data...</p>
        </div>

        <div *ngIf="!isLoading && !rowCountsMatch" class="error-message">
            <p>Data row count between all input Excel files must match.</p>
            <p class="error-details">
                Invoice files: {{ invoiceFiles.length }} file(s)
                <span *ngFor="let file of invoiceFiles"> - {{ file.fileName }} ({{ file.rowCount }} rows)</span>
            </p>
            <p class="error-details">
                Supplier Quotation files: {{ supplierQuotationFiles.length }} file(s)
                <span *ngFor="let file of supplierQuotationFiles"> - {{ file.fileName }} ({{ file.rowCount }}
                    rows)</span>
            </p>
        </div>

        <div *ngIf="!isLoading && rowCountsMatch && invoiceData.length > 0" class="comparison-table-container">
            <div class="table-wrapper">
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th [attr.colspan]="invoiceHeaders.length" class="invoice-column">Invoice</th>
                            <th *ngFor="let file of supplierQuotationFiles; let i = index"
                                [attr.colspan]="getSupplierQuotationHeaderLength(i)"
                                [class]="i % 2 === 0 ? 'supplier-column' : 'supplier-column-alt'">
                                {{ file.fileName }}
                            </th>
                        </tr>
                        <tr>
                            <th *ngFor="let header of invoiceHeaders" class="invoice-column">{{ header }}</th>
                            <ng-container *ngFor="let headers of supplierQuotationHeaders; let fileIndex = index">
                                <th *ngFor="let header of headers"
                                    [class]="fileIndex % 2 === 0 ? 'supplier-column' : 'supplier-column-alt'">{{ header
                                    }}</th>
                            </ng-container>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let invoiceRow of invoiceData; let rowIndex = index">
                            <td *ngFor="let header of invoiceHeaders" class="invoice-column">
                                {{ getCellValue(invoiceRow, header) }}
                            </td>
                            <ng-container *ngFor="let fileHeaders of supplierQuotationHeaders; let fileIndex = index">
                                <td *ngFor="let header of fileHeaders"
                                    [class]="fileIndex % 2 === 0 ? 'supplier-column' : 'supplier-column-alt'">
                                    {{ getSupplierQuotationValue(fileIndex, rowIndex, header) }}
                                </td>
                            </ng-container>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div *ngIf="!isLoading && rowCountsMatch && invoiceData.length === 0" class="no-data-message">
            <p>No data available. Please upload files on the Inputs page.</p>
        </div>
    </div>
</div>